<div class="container">
  <div class="schedule-block">
    <section class="group-block" *ngFor="let item of schedules">
      <ng-container *ngIf="item.matches.length">
        <h4 class="group-title txt-center">Group {{item.groupName}}</h4>
        <div *ngIf="item.matches.round === 4.2">
          <span *ngIf="!auth.isLoggedIn()" colspan="3" class="final-title">
            Final
          </span>
          <span *ngIf="auth.isLoggedIn() && !auth.currentUser.admin" colspan="4" class="final-title">
            Third and four
          </span>
        </div>
        <app-matches [matches]="item.matches" [home]="false" [flag]="flag" (openModal)="openModal($event)">
        </app-matches>
      </ng-container>
    </section>
  </div>
  <app-sidebar></app-sidebar>
</div>

<div #modal class="prediction-page modal txt-bold">
  <div class="modal-content">
    <span (click)="closeModal()" class="close txt-bold">&times;</span>
    <form class="prediction-form" #elmForm="ngForm" (ngSubmit)="submit(elmForm, _match)">
      <div class="prediction-heading txt-center">
        <p>
          <b *ngIf="auth.isLoggedIn() && !auth.currentUser.admin">
            Predict Match
          </b>
          <b *ngIf="auth.isLoggedIn() && auth.currentUser.admin">
            Edit Match
          </b>
        </p>
      </div>
      <div class="score-avatar" [style.backgroundImage]="'url('+ imageSource +')'">
        <div class="info-match txt-center">
          <div class="info-match-time">
            {{ _match.start_at | date:'MMMM, dd | h:mm a' || 'Undefined' }}
          </div>
        </div>
        <div class="score-prediction">
          <div class="name-team-1">
            <img *ngIf="_match.firstTeam" [src]="_match.firstTeam.logo" alt="" class="logo-size">
            <p class="code-team">{{ _match.firstTeam?.code }}</p>
          </div>
          <div class="prediction-middle" *ngIf="!_match?.prediction?.is_predicted || auth.currentUser.admin">
            <input type="number" #firstTeamValue name="firstTeamScore" ngModel value="{{ _match.firstTeam?.score }}" class="prediction" min="0" required>
            <span *ngIf="_match.firstTeam?.winner">*</span>
            <div class="cross"><p>-</p></div>
            <input type="number" #secondTeamValue name="secondTeamScore" ngModel value="{{ _match.secondTeam?.score }}" class="prediction" min="0" required>
            <span *ngIf="_match.secondTeam?.winner">*</span>
            <ng-container *ngIf="_match.round !== 1 && firstTeamValue?.value === secondTeamValue?.value">
              <div class="winner1">
                Winner: <input #leftWinner class="" type="radio" name="checkWinner" value="{{ !flag }}" (change)="changeFlag()">
              </div>
              <div class="winner2">
                Winner: <input #rightWinner class="" type="radio" name="checkWinner" value="{{ flag }}" (change)="changeFlag()">
              </div>
            </ng-container>
          </div>
          <div class="name-team-2">
            <img *ngIf="_match.secondTeam" [src]="_match.secondTeam.logo" alt="" class="logo-size">
            <p class="code-team">{{ _match.secondTeam?.code }}</p>
          </div>
          <button class="btn-prediction" [class.display-none]="_match?.prediction?.is_predicted && !auth.currentUser.admin"
            [disabled]="!firstTeamValue?.nativeElement?.value || !secondTeamValue?.nativeElement?.value">Submit</button>
        </div>
      </div>
    </form>
  </div>
</div>
